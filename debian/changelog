debswarm (1.9.0-2) stable; urgency=medium

  * Scheduled Sync Windows - time-based download scheduling
    - Configure sync windows for off-peak downloading (nights, weekends)
    - Rate limiting outside windows (default 100KB/s) instead of blocking
    - Security updates always get full speed regardless of schedule
    - Timezone-aware scheduling with flexible day patterns
    - New [scheduler] config section with [[scheduler.windows]] entries
  * Fleet Coordination - LAN download deduplication
    - Peers coordinate to avoid redundant WAN downloads
    - Election-based fetcher selection using random nonces
    - Progress broadcasting across fleet peers
    - Automatic fallback if coordination fails
    - New [fleet] config section
  * New Prometheus metrics for scheduler and fleet monitoring
  * P2P node: add GetMDNSPeers() and Host() methods
  * Update golangci-lint to v2 format
  * Fix errcheck lint issues

 -- debswarm developers <debswarm@example.com>  Sat, 21 Dec 2025 00:00:00 +0000

debswarm (1.8.0-1) stable; urgency=medium

  * LAN Peer Priority - mDNS-discovered peers get scoring boost
    - New proximity weight (15%) in peer scoring algorithm
    - mDNS peers get proximity score 1.0, DHT peers get 0.3
    - Peers discovered via mDNS automatically marked for priority
  * Offline-First Mode - automatic connectivity detection and fallback
    - Three modes: online (full), lan_only (mDNS only), offline (cache only)
    - Configurable connectivity_mode: auto, lan_only, online_only
    - Background connectivity monitoring with configurable interval
    - Health endpoint includes connectivity_mode field
  * Audit Log Export - structured JSON logging for compliance
    - Events: download complete/failed, upload, cache hit, verification failed
    - JSON Lines format for ELK, Splunk, jq compatibility
    - Automatic file rotation with configurable size and backups
    - New [logging.audit] config section
  * Peer scoring weights adjusted for proximity factor
    - Latency 25%, Throughput 25%, Reliability 20%, Freshness 15%, Proximity 15%

 -- debswarm developers <debswarm@example.com>  Wed, 18 Dec 2025 00:00:00 +0000

debswarm (1.7.0-1) stable; urgency=medium

  * Streaming downloads for memory efficiency
    - Large files (>=10MB) now stream to disk instead of memory
    - Eliminates memory exhaustion for large packages
    - Memory usage reduced from ~file_size to ~32MB for chunked downloads
  * Increase peer score cache TTL from 1min to 5min
  * Add cache.PutFile() for atomic file moves

 -- debswarm developers <debswarm@example.com>  Wed, 18 Dec 2025 00:00:00 +0000

debswarm (1.6.0-1) stable; urgency=high

  * Security: Eclipse attack mitigation
    - Block connections to/from private/reserved IP addresses
    - Filter multiaddrs in InterceptAccept and InterceptAddrDial
  * Security: Skip DHT announcements in private swarm mode
  * Security: Validate byte range bounds in transfer requests
  * Security: Filter blocked addresses from DHT provider results

 -- debswarm developers <debswarm@example.com>  Wed, 18 Dec 2025 00:00:00 +0000

debswarm (1.5.1-1) stable; urgency=medium

  * Fix golangci-lint gofmt errors in rate limiting code
  * Fix ineffassign error in peer limiter test

 -- debswarm developers <debswarm@example.com>  Tue, 17 Dec 2025 00:00:00 +0000

debswarm (1.5.0-1) stable; urgency=medium

  * Add per-peer rate limiting
    - Configurable per_peer_upload_rate and per_peer_download_rate
    - Auto mode divides global limit by expected number of peers
  * Add adaptive rate limiting
    - Integrates with peer scoring system
    - High-performing peers get boosted rates
    - Poorly-performing peers get reduced rates

 -- debswarm developers <debswarm@example.com>  Tue, 17 Dec 2025 00:00:00 +0000

debswarm (1.4.2-1) stable; urgency=medium

  * Add enhanced mDNS discovery logging
    - Log listen addresses when mDNS starts
    - Log when mDNS is explicitly disabled
    - Log discovered peer addresses (not just peer ID)
    - Log successful mDNS peer connections at Info level

 -- debswarm developers <debswarm@example.com>  Wed, 18 Dec 2025 00:00:00 +0000

debswarm (1.4.1-1) unstable; urgency=medium

  * Fix identity show to use same data directory resolution as daemon
  * Fix status command to use configured metrics bind/port instead of hardcoded values
  * Fix peers command hardcoded metrics URL
  * Fix config show to display all configuration fields (was missing many sections)
  * Add comprehensive configuration documentation (docs/configuration.md)
  * Fix grep pattern for peerID in bootstrap-node.md
  * Remove incorrect CGO/GCC build requirements from documentation

 -- debswarm developers <debswarm@example.com>  Wed, 18 Dec 2025 00:00:00 +0000

debswarm (1.4.0-1) unstable; urgency=medium

  * Add automatic retry for failed downloads
    - Configurable retry_max_attempts, retry_interval, retry_max_age
    - Failed downloads automatically retried on next APT request
    - Exponential backoff between retry attempts

 -- debswarm developers <debswarm@example.com>  Tue, 17 Dec 2025 00:00:00 +0000

debswarm (1.3.3-1) unstable; urgency=medium

  * Add log sanitization for security
    - Sanitize peer IDs and file paths in log output
    - Prevent potential log injection attacks

 -- debswarm developers <debswarm@example.com>  Tue, 17 Dec 2025 00:00:00 +0000

debswarm (1.3.2-1) unstable; urgency=medium

  * Add --cache-path flag to seed command
    - Override default cache path when importing packages

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.3.1-1) unstable; urgency=medium

  * Fix contextcheck lint error in keepalive goroutine

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.3.0-1) unstable; urgency=medium

  * Add keepalive pings to prevent idle peer connections from being pruned
  * Increase connection manager grace period from 1 to 10 minutes

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.2.6-1) unstable; urgency=medium

  * Re-release of v1.2.5 (CI asset conflict)

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.2.5-1) unstable; urgency=medium

  * Switch from DynamicUser to static debswarm user for reliable permissions
  * postinst creates debswarm system user/group and sets directory ownership
  * Remove StateDirectory/CacheDirectory to avoid conflicts with manual setup
  * Auto-detect /var/lib/debswarm for data directory on system installs

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.2.1-1) unstable; urgency=medium

  * Fix CACHE_DIRECTORY to correctly override config file path setting

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.2.0-1) unstable; urgency=medium

  * Add automatic detection of systemd CACHE_DIRECTORY and STATE_DIRECTORY
  * Fix directory validation to work with systemd ProtectSystem=strict
  * Running under systemd now works out-of-box without config changes

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.1.1-1) unstable; urgency=medium

  * Fix import ordering in cache.go for golangci-lint

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.1.0-1) unstable; urgency=medium

  * Replace mattn/go-sqlite3 with modernc.org/sqlite (pure Go implementation)
    - No longer requires CGO or C compiler to build
    - Enables cross-compilation without CGO toolchain
    - Works out-of-box on Windows without MinGW/TDM-GCC

 -- debswarm developers <debswarm@example.com>  Mon, 16 Dec 2025 00:00:00 +0000

debswarm (1.0.1-1) unstable; urgency=medium

  * Fix TOML config parsing for DHT duration fields (provider_ttl, announce_interval)

 -- debswarm developers <debswarm@example.com>  Sun, 15 Dec 2025 00:00:00 +0000

debswarm (1.0.0-1) unstable; urgency=medium

  * First stable release - production ready
  * Add runtime profiling (pprof endpoints at /debug/pprof/)
  * Add E2E integration tests for proxy, cache, index, and P2P flows
  * Add CLI smoke tests for command coverage
  * Add MaxHeaderBytes limit (1MB) to all HTTP servers for DoS protection
  * All critical, high, and medium priority items complete

 -- debswarm developers <debswarm@example.com>  Sun, 15 Dec 2025 00:00:00 +0000

debswarm (0.8.2-1) unstable; urgency=medium

  * Enforce MaxConcurrentUploads and MaxConcurrentPeerDownloads config options
    - Wire transfer.max_concurrent_uploads to P2P upload handler
    - Wire transfer.max_concurrent_peer_downloads to downloader
  * Fix debian package build (remove redundant debian/install entries)

 -- debswarm developers <debswarm@example.com>  Sun, 15 Dec 2025 00:00:00 +0000

debswarm (0.8.0-1) unstable; urgency=medium

  * Add pre-flight directory validation for systemd compatibility
    - Validates cache and data directories exist or can be created
    - Tests write permissions before daemon startup
    - Catches StateDirectory/CacheDirectory issues early

 -- debswarm developers <debswarm@example.com>  Sun, 15 Dec 2025 00:00:00 +0000

debswarm (0.7.0-1) unstable; urgency=medium

  * Add config file validation on startup with detailed error messages
  * Add crash recovery for corrupted partial download state
  * Add SIGHUP handler for config reload without restart
  * Improve documentation with troubleshooting guide

 -- debswarm developers <debswarm@example.com>  Sun, 15 Dec 2025 00:00:00 +0000

debswarm (0.6.2-1) unstable; urgency=medium

  * Add MaxConnections config option for connection limits
  * Add MinFreeSpace config option for disk space management
  * Add /health endpoint for monitoring
  * Add 1.0 release roadmap documentation

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.6.1-1) unstable; urgency=medium

  * Add peers table to web dashboard
  * Expand metrics collection
  * Dashboard and metrics improvements

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.6.0-1) unstable; urgency=medium

  * Add download resume support with chunk persistence
  * Add HTTP Range request support for mirror fetcher
  * Fix gosec security issues
  * Improve test coverage across all packages
  * Improve CI/CD workflows

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.6-1) unstable; urgency=medium

  * Fix shutdown hang from context leak in DHT announcement worker
    - Announcements now properly terminate on server shutdown
  * Fix goroutine leak in DHT provider discovery
    - Channel is now drained when breaking early from provider search
  * Add comprehensive test coverage for cache, peers, and downloader packages
    - 48 new tests with race detection

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.5-1) unstable; urgency=medium

  * Security: Add HTTP security headers to dashboard and metrics endpoints
    - X-Content-Type-Options, X-Frame-Options, Cache-Control, X-XSS-Protection
    - Content-Security-Policy for dashboard
  * Security: Add response size limit (500MB) to mirror fetcher
    - Prevents memory exhaustion from malicious/misconfigured mirrors
  * Refactor: Extract SSRF validation to shared internal/security package
  * Cleanup: Remove redundant min() function (use Go 1.21+ built-in)

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.3-1) unstable; urgency=high

  * Security: Fix SSRF vulnerability in index URL fetching
    - Block requests to localhost, cloud metadata services, private networks
    - Validate URLs match Debian/Ubuntu repository patterns
  * Security: Fix information disclosure in dashboard error messages
  * Security: Add documentation for metrics endpoint exposure risks
  * Add test coverage for SSRF URL validation

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.2-1) unstable; urgency=medium

  * Update libp2p to v0.46.0
  * Update go-sqlite3 to v1.14.32
  * Fix debian cross-compilation for arm64
  * Make version dynamic in debian/rules

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.1-1) unstable; urgency=medium

  * Update libp2p to v0.45.0 and kad-dht to v0.36.0
  * Update cobra to v1.10.2
  * Fix identity key loading for libp2p compatibility
  * Update GoReleaser config to v2
  * CI now uses Go 1.24.6

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2025 00:00:00 +0000

debswarm (0.5.0-1) unstable; urgency=medium

  * Fix race condition in cache reader tracking (TOCTOU bug)
  * Fix goroutine leak on chunk download failure
  * Fix blacklist flag inconsistency after expiration
  * Fix stream deadline error handling in P2P transfers
  * Improve error context in download retry loops
  * Add context propagation to rate limiter for proper cancellation
  * Add proper goroutine cleanup in announcement worker
  * Add benchmark command with simulated peers for performance testing

 -- debswarm developers <debswarm@example.com>  Sat, 14 Dec 2024 00:00:00 +0000

debswarm (0.4.0-1) unstable; urgency=medium

  * Multi-repository support with proper isolation
  * Auto-indexing of Packages files when APT fetches them
  * Persistent identity (stable peer IDs across restarts)
  * Identity CLI commands (show, regenerate)
  * Remote monitoring (--metrics-bind flag)
  * Request coalescing for concurrent downloads
  * O(1) basename index for faster lookups
  * Security: SSRF mitigation, metrics server hardening, CSS injection fix

 -- debswarm developers <debswarm@example.com>  Fri, 13 Dec 2024 00:00:00 +0000

debswarm (0.3.0-1) unstable; urgency=medium

  * Bandwidth limiting (--max-upload-rate, --max-download-rate)
  * Web dashboard at /dashboard
  * Private swarms (PSK) support
  * Peer allowlist
  * PSK management CLI (generate, show)
  * Mirror sync mode for seed import

 -- debswarm developers <debswarm@example.com>  Fri, 13 Dec 2024 00:00:00 +0000

debswarm (0.2.6-1) unstable; urgency=medium

  * Add seed command to import .deb files and announce to DHT
  * Update documentation for seeding feature

 -- debswarm developers <debswarm@example.com>  Fri, 13 Dec 2024 00:00:00 +0000

debswarm (0.2.5-1) unstable; urgency=medium

  * Initial release.
  * Features:
    - Transparent APT HTTP proxy integration
    - P2P package distribution via libp2p/Kademlia DHT
    - Parallel chunked downloads from multiple peers
    - Adaptive timeouts based on network conditions
    - Peer scoring for optimal peer selection
    - QUIC transport preference for NAT traversal
    - Prometheus metrics endpoint
    - Content-addressed cache with SQLite metadata
    - mDNS local network discovery
    - SHA256 verification of all P2P downloads
    - Automatic mirror fallback

 -- debswarm developers <debswarm@example.com>  Thu, 12 Dec 2024 00:00:00 +0000
