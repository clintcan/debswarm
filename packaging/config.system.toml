# debswarm system configuration
# Installed to /etc/debswarm/config.toml by the .deb package
# Paths configured for systemd service with DynamicUser
#
# For complete documentation, see:
# https://github.com/debswarm/debswarm/blob/main/docs/configuration.md

[network]
listen_port = 4001
proxy_port = 9977
max_connections = 100
# connectivity_mode = "auto"  # "auto", "lan_only", "online_only"

# NAT traversal (v1.13+)
# enable_relay = true         # Use circuit relays to reach NAT'd peers
# enable_hole_punching = true # Enable direct NAT hole punching

# libp2p public bootstrap nodes
bootstrap_peers = [
  "/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN",
  "/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa",
  "/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb",
  "/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt",
]

[cache]
# System paths for systemd service
path = "/var/cache/debswarm"
max_size = "10GB"
min_free_space = "1GB"

[transfer]
max_upload_rate = "0"
max_download_rate = "0"
# Per-peer rate limiting (default: auto)
# per_peer_upload_rate = "auto"
# per_peer_download_rate = "auto"
# expected_peers = 10
max_concurrent_uploads = 20
max_concurrent_peer_downloads = 10
retry_max_attempts = 3
retry_interval = "5m"
retry_max_age = "1h"

[dht]
provider_ttl = "24h"
announce_interval = "12h"

[privacy]
enable_mdns = true
announce_packages = true
# psk_path = "/etc/debswarm/swarm.key"
# peer_allowlist = []
# peer_blocklist = []

[metrics]
port = 9978
bind = "127.0.0.1"

[logging]
level = "info"
file = ""

# Audit logging (v1.8+)
# [logging.audit]
# enabled = true
# path = "/var/log/debswarm/audit.json"
# max_size_mb = 100
# max_backups = 5

# Scheduled sync windows (v1.9+)
# [scheduler]
# enabled = true
# timezone = "America/New_York"
# outside_window_rate = "100KB/s"

# Fleet coordination (v1.9+)
# [fleet]
# enabled = true
# claim_timeout = "5s"
# max_wait_time = "5m"

# Package index settings (v1.18+)
[index]
# Parse APT's local package lists to enable P2P even when apt update bypasses proxy
apt_lists_path = "/var/lib/apt/lists"
watch_apt_lists = true
